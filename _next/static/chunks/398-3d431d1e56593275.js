"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[398],{2998:function(e,t,n){function r(){try{let e=localStorage.getItem("petition_session_id");e||(e=Math.random().toString(36).substring(2,15)+Date.now().toString(),localStorage.setItem("petition_session_id",e));let t=Date.now().toString(),n=document.createElement("canvas"),r=n.getContext("2d");r&&(r.textBaseline="top",r.font="14px Arial",r.fillText("Browser fingerprint",2,2));let a=function(){try{let e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(t){let e=t.getExtension("WEBGL_debug_renderer_info");if(e)return t.getParameter(e.UNMASKED_RENDERER_WEBGL)||"unknown";return t.getParameter(t.RENDERER)||"unknown"}return"no-webgl"}catch(e){return"webgl-error"}}(),o=function(){try{if(window.AudioContext||window.webkitAudioContext)return"audio-skipped";return"no-audio"}catch(e){return"audio-error"}}(),i=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),n.toDataURL(),navigator.hardwareConcurrency||0,navigator.maxTouchPoints||0,navigator.platform,window.devicePixelRatio||1,e,t,a,o,navigator.cookieEnabled?"1":"0",navigator.doNotTrack||"0",window.location.hostname,performance.now().toString()].join("|"),s=0;for(let e=0;e<i.length;e++){let t=i.charCodeAt(e);s=(s<<5)-s+t,s&=s}let l=Math.abs(s).toString(36);return l.length<16?l=l.padEnd(16,"0"):l.length>16&&(l=l.slice(0,16)),console.log("Generated fingerprint:",l),l}catch(a){console.error("Fingerprint generation failed:",a);let e=Math.random().toString(36).substring(2,15),t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,e,Date.now().toString()].join("|"),n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n&=n;let r=Math.abs(n).toString(36);return r.length<16?r=r.padEnd(16,"0"):r.length>16&&(r=r.slice(0,16)),console.log("Fallback fingerprint:",r),r}}n.d(t,{pt:function(){return r}})},9637:function(e,t,n){function r(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||"string"!=typeof e)return{valid:!1,message:"Comment cannot be empty"};let n=e.trim(),r=t?5:10;if(n.length<r)return{valid:!1,message:"Comment must be at least ".concat(r," characters long")};let a=t?2e3:1e3;if(n.length>a)return{valid:!1,message:"Comment must be less than ".concat(a," characters")};let o=[/(http|https|www\.)/gi,/[A-Z]{15,}/g,/(.)\1{8,}/g];for(let e of(t||o.push(/\b(buy|sell|free|money|cash|click|here|now)\b/gi,/(.)\1{5,}/g),o))if(e.test(n))return{valid:!1,message:"Comment contains suspicious content"};return{valid:!0,sanitized:function(e){if("string"!=typeof e)return"";let t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"");return(t=(t=(t=(t=(t=(t=(t=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")).replace(/javascript:/gi,"")).replace(/vbscript:/gi,"")).replace(/on\w+\s*=/gi,"")).replace(/(';)|(\-\-)|(\s+or\s+)|(\s+and\s+)/gi,"")).replace(/[ \t]+/g," ")).replace(/\n{3,}/g,"\n\n")).trim()}(n)}}n.d(t,{Dn:function(){return l},Lm:function(){return g},Vl:function(){return r},dH:function(){return c}});class a{isAllowed(e){let t=Date.now(),n=(this.attempts.get(e)||[]).filter(e=>t-e<this.windowMs);return!(n.length>=this.maxAttempts)&&(n.push(t),this.attempts.set(e,n),!0)}getRemainingTime(e){let t=this.attempts.get(e)||[];return t.length<this.maxAttempts?0:Math.max(0,this.windowMs-(Date.now()-Math.min(...t)))}constructor(e=5,t=6e4){this.attempts=new Map,this.maxAttempts=e,this.windowMs=t}}let o=new a(3,6e4),i=new a(10,6e4),s=new a(5,3e5);function l(e,t,n){if("string"==typeof t){let n;switch(e){case"comment":n=o;break;case"vote":n=i;break;case"signature":n=s;break;default:return{allowed:!1}}let r=n.isAllowed(t),a=r?0:n.getRemainingTime(t);return{allowed:r,remainingTime:a}}return new Promise(r=>{try{let a="rate_limit_".concat(e),o=Date.now(),i=localStorage.getItem(a),s=[];if(i)try{let e=JSON.parse(i);s=Array.isArray(e)?e:[]}catch(e){s=[]}let l="number"==typeof t?t:"survey_submission"===e?3:5,c=n||("survey_submission"===e?36e5:6e4),g=s.filter(e=>o-e<c);if(g.length>=l){r(!1);return}g.push(o),localStorage.setItem(a,JSON.stringify(g)),r(!0)}catch(e){console.error("Rate limit check error:",e),r(!0)}})}function c(e){let t=Math.ceil(e/1e3);if(t<60)return"".concat(t," seconds");let n=Math.ceil(t/60);return"".concat(n," minute").concat(1!==n?"s":"")}function g(){try{let e=localStorage.getItem("voting_session_id");if(!e){let t=navigator.userAgent+navigator.language+screen.width+"x"+screen.height;e=btoa(t+Math.random().toString(36)+Date.now().toString()).slice(0,20),localStorage.setItem("voting_session_id",e)}let t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),navigator.hardwareConcurrency||0,navigator.maxTouchPoints||0,navigator.platform,window.devicePixelRatio||1,navigator.cookieEnabled?"1":"0",navigator.doNotTrack||"0",e,Math.floor(Date.now()/864e5),navigator.vendor,navigator.product,navigator.appVersion,window.location.hostname,performance.now().toString()],n=document.createElement("canvas"),r=n.getContext("2d");r&&(r.textBaseline="top",r.font="14px Arial",r.fillText("Browser fingerprint",2,2),t.push(n.toDataURL()));let a=t.join("|"),o=0;for(let e=0;e<a.length;e++){let t=a.charCodeAt(e);o=(o<<5)-o+t,o&=o}let i=Math.abs(o).toString(36);return i.length<16?i=i.padEnd(16,"0"):i.length>16&&(i=i.slice(0,16)),i}catch(a){console.error("Secure fingerprint generation failed:",a);let e=localStorage.getItem("voting_session_id");e||(e=btoa(navigator.userAgent+navigator.language+screen.width+"x"+screen.height+Math.random().toString(36)+Date.now().toString()).slice(0,20),localStorage.setItem("voting_session_id",e));let t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,e,Math.floor(Date.now()/864e5),navigator.vendor,navigator.product,window.location.hostname,performance.now().toString()].join("|"),n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n&=n;let r=Math.abs(n).toString(36);return r.length<16?r=r.padEnd(16,"0"):r.length>16&&(r=r.slice(0,16)),r}}new a(3,36e5)},2141:function(e,t,n){n.d(t,{O:function(){return s}});var r=n(1545);let a="https://rnnzekyvmaibmewzxypa.supabase.co/",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJubnpla3l2bWFpYm1ld3p4eXBhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5OTE0NzUsImV4cCI6MjA3NTU2NzQ3NX0.3ZwEnR0up8Ma7KExtXFzTP0xFV-MocwsScjiSbYCVCI";console.log("Supabase config check:",{url:a?"Present":"Missing",key:o?"Present":"Missing",nodeEnv:"production"});let i=null;a&&o?i=(0,r.eI)(a,o,{auth:{persistSession:!1}}):console.warn("Supabase environment variables not available - client will be null");let s=i}}]);